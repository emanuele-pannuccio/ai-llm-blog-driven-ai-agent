{"title": "Cloud Economics", "link": "https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/", "content": "<h2>Part 1: Laying out foundations for multicloud and hybrid cloud financial governance</h2>\n\n\n\n<p>In this post, we discuss Cloud Economics. This is showcased on <a href=\"https://devblogs.microsoft.com/premier-developer/cloud-economics/\">Microsoft Premier Developer Blog</a>. We will focus on <a href=\"https://docs.microsoft.com/en-us/azure/architecture/framework/#cost-optimization\">Cost Optimization</a> which is the first pillar of the <a href=\"https://docs.microsoft.com/en-us/azure/architecture/framework/\">Microsoft Azure Well-Architected Framework</a>. However, whenever possible, we will extract principles that apply to other Cloud Service Providers (CSP) such as <a href=\"https://aws.amazon.com/\">Amazon Web Services</a> (AWS) and <a href=\"https://cloud.google.com/\">Google Cloud Platform</a> (GCP). The purpose is to cover today&#8217;s reality: many enterprises and organizations are entrenched in <a href=\"https://en.wikipedia.org/wiki/Multicloud\">Multicloud</a> and <a href=\"https://en.wikipedia.org/wiki/Cloud_computing#Hybrid_cloud\">Hybrid Cloud</a> architectures. Thus any unified and consolidated approach must encompass these cloud models.</p>\n\n\n\n<p>I started my journey as Chief Information Officer (CIO) of <a href=\"https://www.structube.com/\">Structube</a>, a medium-sized furniture retailer in Canada. An all Microsoft shop with a traditional On-Premise datacenter, the natural choice for a cloud service provider is <a href=\"https://azure.microsoft.com/en-us/\">Microsoft Azure</a>. However, like any fast growing company with relatively autonomous departments, as much as one would like to stick to a single strategic cloud provider or technology stack, inevitably, others creep in.</p>\n\n\n\n<p>In any such environment, with multiple technology stacks, operating systems, and devices to manage and support, Information Technology (IT) governance is challenging to say the least. The same is true for financial aspects of IT governance (i.e. <em><strong>financial governance</strong></em>).</p>\n\n\n\n<p>With the advent of cloud, terms such as <a href=\"https://en.wikipedia.org/wiki/Commoditization\">commoditization</a> have been used. While we are not interested in the polemic of whether computing has become a commodity akin to electricity, oil, gold, or wheat, we are distinctly aware that we are charged computing consumption at precise and predictable hourly rates (see <a href=\"https://azure.microsoft.com/en-ca/pricing/calculator/\">Azure Pricing Calculator</a>, <a href=\"https://cloud.google.com/products/calculator/\">Google Cloud Pricing Calculator</a>, and <a href=\"https://calculator.aws/#/\">AWS Pricing Calculator</a>). Furthermore, new cloud pricing models have emerged such as <strong><em>reservations</em></strong> (see <a href=\"https://azure.microsoft.com/en-us/reservations/\">Reservations</a>,  <a href=\"https://aws.amazon.com/aws-cost-management/aws-cost-optimization/reserved-instances/?track=costop\">Reserved Instances</a>,  <a href=\"https://cloud.google.com/compute/docs/instances/signing-up-committed-use-discounts\">Committed Use Discounts</a>), <strong><em>spot pricing</em></strong> (see <a href=\"https://azure.microsoft.com/en-us/pricing/spot/\">Azure Spot Virtual Machines</a>, <a href=\"https://aws.amazon.com/ec2/spot/?track=costop\">EC2 Spot Instances</a>, <a href=\"https://cloud.google.com/preemptible-vms/\">Preemptible Virtual Machines</a>), etc. In addition, CSPs offer <strong><em>a variety of controls</em></strong>, including usage quotas, budget alerts, and organizational permissions.</p>\n\n\n\n<p>In this article, we will explore how to track costs from these 3 cloud service providers. We will also carve out a strategy to estimate on-premise costs. Bear in mind that on-premise cost estimations tend to be <a href=\"https://en.wikipedia.org/wiki/Accuracy_and_precision\">less precise (and/or accurate)</a> and can vary greatly from one enterprise or organization to another. <strong>Tracking costs both in the cloud and on-premise in a uniform view is key</strong>: it enables us to perform cost estimation and optimization for <em><strong>all</strong></em> our workloads. This includes on-premise workloads, cloud workloads, hybrid workloads as well as workloads between clouds (i.e. <em>intercloud</em> workloads).</p>\n\n\n\n<p>Before we dive into the details, I highly recommend listening to Adam Ronthal&#8217;s webinar &#8220;<a href=\"https://www.gartner.com/en/webinars/3991979/the-future-of-data-analytics-is-in-the-cloud\">The Future of Data &amp; Analytics is in the Cloud</a>&#8220;. <a href=\"https://www.gartner.com/analyst/52420/Adam-Ronthal\">Adam Ronthal</a> is VP Analyst at <a href=\"https://www.gartner.com/en\">Gartner</a> and has published many articles and webinars on financial governance for cloud among other topics. One of many key takeaways of his presentation is that the key metric you want to look at when doing cost optimization is the <a href=\"https://en.wikipedia.org/wiki/Price%E2%80%93performance_ratio\">Price-Performance ratio</a>.</p>\n\n\n\n<h3 id=\"the-comprehensive-cost-dashboard\">The Comprehensive Cost Dashboard</h3>\n\n\n\n<h4>A work in progress&#8230;</h4>\n\n\n\n<p><strong>The scenario</strong>: <em>DevOps ABCs</em> is an organization with cloud footprint in <strong><em>Azure</em></strong> (7 active subscriptions), <strong><em>GCP</em></strong> (2 billing accounts), and <strong><em>AWS</em></strong> (a single account). On September 1st 2018, it has purchased 2 physical servers: <em><strong>Windows Server A</strong></em> (with <a href=\"https://www.microsoft.com/en-ca/sql-server/sql-server-2019\">Microsoft SQL Server</a>) and <em><strong>Linux Server A</strong></em> (with a <a href=\"https://www.mysql.com/\">MySQL Server</a>). Both are hosted on-premises. The Windows Server A is amortized over 5 years while the Linux Server A is amortized over 3 years.</p>\n\n\n\n<p>For the reader who wants to jump straight to the highlights of the dashboard, head <a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#without-further-ado\">here</a>.</p>\n\n\n\n<p>Also, if you wish to jump straight to the following implementations, please feel free to do so</p>\n\n\n\n<ul><li><a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#microsoft-azure\">Microsoft Azure</a></li><li><a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#amazon-web-services\">Amazon Web Services</a></li><li><a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#google-cloud-platform\">Google Cloud Platform</a></li></ul>\n\n\n\n<p>For those wondering &#8220;<a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#what-s-my-return-on-investment\">Why should I care?</a>&#8220;</p>\n\n\n\n<p>For the brave souls, please continue on&#8230;</p>\n\n\n\n<h3 id=\"implementation-of-the-cost-dashboard\">Implementation of the Cost Dashboard</h3>\n\n\n\n<h4 id=\"microsoft-azure\">Microsoft Azure</h4>\n\n\n\n<p>Here is a full hierarchy of the <a href=\"https://docs.microsoft.com/en-us/azure/governance/management-groups/overview\">Azure Management Groups</a>:</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy-993x1024.png\" alt=\"\" class=\"wp-image-255\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy-993x1024.png 993w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy-291x300.png 291w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy-768x792.png 768w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/01-Management-Hierarchy.png 1087w\" sizes=\"(max-width: 993px) 100vw, 993px\" /></a><figcaption><strong>Figure 1</strong><br>There are 22 Management Groups containing a total of 7 subscriptions</figcaption></figure>\n\n\n\n<p>We notice that some of these Management Groups come from the <a href=\"https://github.com/Azure/Enterprise-Scale#objective\">Enterprise-Scale &#8211; Reference Implementation in GitHub</a>. Best practices for how to organize your Azure resources effectively is deferred to the <a href=\"https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-setup-guide/organize-resources?tabs=AzureManagementGroupsAndHierarchy\">Cloud Adoption Framework</a>. </p>\n\n\n\n<h4 id=\"guiding-principles\">Guiding Principles</h4>\n\n\n\n<p>Of note with respect to <em>costing</em>, we adhere to the following two guiding principles:</p>\n\n\n\n<ol><li>Resources that are dependent to each other and have <em><strong>the same lifecycle</strong></em> should belong to the same container (e.g. subscription or resource group). For instance, a web app with a database backend in a given environment (e.g. Dev, Test, or Production) should belong to the same resource group; in particular, if all 3 environments are used, we would require 3 resource groups, <em>one for each environment</em>.</li><li>Shared resources that are used by multiple workloads should be placed in their own container. For instance, a network infrastructure (e.g. an Azure Virtual Network) used to <a href=\"https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/vpn\">Extend an on-premises network using VPN</a> to Azure should be in its own resource group. Another example is a resource group that contains resources for a workload that collects monitoring data, cost data or DevOps metrics data across all resources in a cloud. Indeed, <em><strong>our Comprehensive Cost Dashboard depends on such a workload</strong></em>! (see Figure 2)</li></ol>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/02-Cost-App-for-Dev-Environment.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/02-Cost-App-for-Dev-Environment-1024x542.png\" alt=\"\" class=\"wp-image-261\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/02-Cost-App-for-Dev-Environment-1024x542.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/02-Cost-App-for-Dev-Environment-300x159.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/02-Cost-App-for-Dev-Environment-768x406.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 2</strong><br>The Cost App Resource Group for the Dev Environment</figcaption></figure>\n\n\n\n<h4 id=\"amazon-web-services\">Amazon Web Services</h4>\n\n\n\n<p>For cost management in AWS, we opted to monitor and control our AWS spending in Azure Cost Management. This can be done in a few minutes by following the documentation &#8220;<a href=\"https://docs.microsoft.com/en-us/azure/cost-management-billing/costs/aws-integration-set-up-configure\">Set up and configure AWS Cost and Usage report integration</a>&#8220;. (see Figure 3)</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/03-AWS-external-costs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/03-AWS-external-costs-1024x560.png\" alt=\"\" class=\"wp-image-269\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/03-AWS-external-costs-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/03-AWS-external-costs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/03-AWS-external-costs-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 3</strong><br>Monitoring AWS spending in Azure Cost Management</figcaption></figure>\n\n\n\n<p>We are then able to use the same techniques to pull cost and usage data from AWS as the ones used to pull cost and usage data from Azure. While these techniques warrant a whole post on their own, we briefly mention that we are continuously pulling cost and usage data from the <a href=\"https://docs.microsoft.com/en-us/rest/api/cost-management/\">Azure Cost Management APIs</a> orchestrated by a <a href=\"https://azure.microsoft.com/en-us/services/data-factory/\">Data Factory</a>. (see Figure 4)</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/04-Data-Factory.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/04-Data-Factory-1024x560.png\" alt=\"\" class=\"wp-image-272\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/04-Data-Factory-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/04-Data-Factory-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/04-Data-Factory-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 4</strong><br>Data Factory used to consolidate cost and usage data from CSPs</figcaption></figure>\n\n\n\n<p>Once <a href=\"https://aws.amazon.com/aws-cost-management/aws-cost-and-usage-reporting/\">AWS Cost and Usage Reports are enabled</a>, cost and usage data is exported hourly (or daily or monthly) to an S3 bucket. (see Figure 5)</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/05-Enable-AWS-Cost-and-Usage-Reports.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/05-Enable-AWS-Cost-and-Usage-Reports-1024x449.png\" alt=\"\" class=\"wp-image-274\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/05-Enable-AWS-Cost-and-Usage-Reports-1024x449.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/05-Enable-AWS-Cost-and-Usage-Reports-300x132.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/05-Enable-AWS-Cost-and-Usage-Reports-768x337.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 5</strong><br>AWS Cost and Usage Reports enabled hourly</figcaption></figure>\n\n\n\n<p>In AWS, we can <a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/tags-billing-cost-center-project/\">divide up our bills by cost center or project</a> by means of tagging, namely, by using <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html\">cost allocation tags</a>. Careful rigor and a <a href=\"https://d1.awsstatic.com/whitepapers/aws-tagging-best-practices.pdf\">thoughtful tagging strategy</a> must be exercised to ensure all resources are tagged appropriately. We can then <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/activating-tags.html\">activate user-defined cost allocation tags</a>. (see Figure 6)</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/06-cost-allocation-tags.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/06-cost-allocation-tags-1024x560.png\" alt=\"\" class=\"wp-image-279\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/06-cost-allocation-tags-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/06-cost-allocation-tags-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/06-cost-allocation-tags-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption>Figure 6<br>Activating Cost allocation tags</figcaption></figure>\n\n\n\n<p>In order to take advantage of the granularity provided by these cost allocation tags, we need to tap into the raw csv cost and usage data exported to the S3 bucket defined above (Figures 7 and 8). Alternatively, we can directly talk to the <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/ce-api.html\">AWS Cost Explorer API</a> as is done in <a href=\"https://github.com/aws-samples/aws-cost-explorer-report\">this GitHub repository</a>.</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/07-s3-bucket-containing-csvs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/07-s3-bucket-containing-csvs-1024x560.png\" alt=\"\" class=\"wp-image-282\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/07-s3-bucket-containing-csvs-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/07-s3-bucket-containing-csvs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/07-s3-bucket-containing-csvs-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 7</strong><br>S3 Bucket containing raw csv cost and usage exported data</figcaption></figure>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/08-sample-cost-allocation-tags.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/08-sample-cost-allocation-tags-1024x378.png\" alt=\"\" class=\"wp-image-283\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/08-sample-cost-allocation-tags-1024x378.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/08-sample-cost-allocation-tags-300x111.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/08-sample-cost-allocation-tags-768x284.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 8</strong><br>Sample cost and usage data containing user-defined cost allocation tags</figcaption></figure>\n\n\n\n<p>Ultimately, warehousing the cost and usage data contained in the exported csv&#8217;s is our preferred approach. This is a great segue to our 3rd CSP which requires yet another technique.</p>\n\n\n\n<h4 id=\"google-cloud-platform\">Google Cloud Platform</h4>\n\n\n\n<p>GCP has deprecated <a href=\"https://cloud.google.com/billing/docs/how-to/export-data-file?_ga=2.99972894.-1498011781.1608127951\">Export Cloud Billing data to a file</a> in favor of <a href=\"https://cloud.google.com/billing/docs/how-to/export-data-bigquery\">Export Cloud Billing data to BigQuery</a>. The latter export method is much more flexible and captures a larger dataset.</p>\n\n\n\n<p>With BigQuery export enabled as in Figure 9, we can query the billing export datasets (see Figure 10).</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export-1024x798.png\" alt=\"\" class=\"wp-image-286\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export-1024x798.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export-300x234.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export-768x599.png 768w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/09-enabled-big-query-export.png 1448w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 9</strong><br> BigQuery export is enabled for Billing Account &#8220;GCP DevOps ABCs Main Billing Account&#8221;</figcaption></figure>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/10-Google-BigQuery-Cloud-Billing-Datasets.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/10-Google-BigQuery-Cloud-Billing-Datasets-1024x560.png\" alt=\"\" class=\"wp-image-287\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/10-Google-BigQuery-Cloud-Billing-Datasets-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/10-Google-BigQuery-Cloud-Billing-Datasets-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/10-Google-BigQuery-Cloud-Billing-Datasets-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 10</strong><br>Querying the billing export datasets in BigQuery for centralized project &#8220;Billing Admin GCP DevOps ABCs&#8221;</figcaption></figure>\n\n\n\n<p>A sample query that fetches a day&#8217;s worth of cost and usage data looks like</p>\n\n\n\n<pre class=\"wp-block-code\"><code>select * from Cloud_Billing_Dataset.gcp_billing_export_v1_01876B_A13DF3_089C65 where usage_start_time>='2021-01-12T00:00:00Z' and usage_start_time&lt;'2021-01-13T00:00:00Z'</code></pre>\n\n\n\n<p>The most effective way to divide up a bill is to break up resources into a Project Container. We defer this to <a href=\"https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy\">Resource hierarchy</a>. Our rather simple resource hierarchy is displayed in Figure 11.</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/11-resource-hierarchy.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/11-resource-hierarchy-1024x530.png\" alt=\"\" class=\"wp-image-290\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/11-resource-hierarchy-1024x530.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/11-resource-hierarchy-300x155.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/11-resource-hierarchy-768x397.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 11</strong><br>Simple resource hierarchy</figcaption></figure>\n\n\n\n<p>From a cost perspective, a Project container for GCP should <em><strong>play the same role</strong></em> as a Resource Group container for Azure. Therefore, the <a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#guiding-principles\">two guiding principles</a> mentioned in the <a href=\"https://blog.devopsabcs.com/index.php/2021/01/15/cloud-economics/#microsoft-azure\">Microsoft Azure section above</a> apply.</p>\n\n\n\n<p>The interested reader may find <a href=\"https://cloud.google.com/files/guide-to-financial-governance.pdf\">a guide to financial governance in the cloud</a> useful.</p>\n\n\n\n<h2 id=\"without-further-ado\">Without further ado&#8230;</h2>\n\n\n\n<p>Let us highlight some key pages of the <a href=\"https://powerbi.microsoft.com/en-us/\">Power BI</a> Comprehensive and Interactive Cost Dashboard.</p>\n\n\n\n<p>First, we have a summary for the total Azure cost by Consumed Service (Figure 12). This dashboard can be sliced by Subscription and Resource Group (Figure 13). We recall that we typically measure the cost of a workload for a given environment at the <em>resource group level</em>.</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/12-total-azure-cost.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/12-total-azure-cost-1024x560.png\" alt=\"\" class=\"wp-image-295\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/12-total-azure-cost-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/12-total-azure-cost-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/12-total-azure-cost-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 12</strong><br>Total Azure Cost by Consumed Service</figcaption></figure>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/13-total-azure-cost-sliced-by-Resource-Group.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/13-total-azure-cost-sliced-by-Resource-Group-1024x560.png\" alt=\"\" class=\"wp-image-296\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/13-total-azure-cost-sliced-by-Resource-Group-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/13-total-azure-cost-sliced-by-Resource-Group-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/13-total-azure-cost-sliced-by-Resource-Group-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 13</strong><br>Total Azure Cost sliced by resource group</figcaption></figure>\n\n\n\n<p>We can view the full history of Azure costs by year and subscription (Figure 14).</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/14-cost-by-year-and-subscription.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/14-cost-by-year-and-subscription-1024x560.png\" alt=\"\" class=\"wp-image-304\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/14-cost-by-year-and-subscription-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/14-cost-by-year-and-subscription-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/14-cost-by-year-and-subscription-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 14</strong><br>Cost by Year and Subscription</figcaption></figure>\n\n\n\n<p>AWS Costs can be monitored in the following screen:</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/15-AWS-costs-by-Consumed-service.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/15-AWS-costs-by-Consumed-service-1024x560.png\" alt=\"\" class=\"wp-image-306\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/15-AWS-costs-by-Consumed-service-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/15-AWS-costs-by-Consumed-service-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/15-AWS-costs-by-Consumed-service-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 15</strong><br>AWS Costs by Consumed Service<br>Sliced by AWS Billing Account, Consumed Service, and Resource Type</figcaption></figure>\n\n\n\n<p>As for GCP costs by service:</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/16-GCP-costs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/16-GCP-costs-1024x560.png\" alt=\"\" class=\"wp-image-307\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/16-GCP-costs-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/16-GCP-costs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/16-GCP-costs-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 16</strong><br>GCP Costs by Service<br>Sliced by Billing Account and Project</figcaption></figure>\n\n\n\n<p>Last, but not least, we need to track on premise costs. To this end, we use the following excel file inspired by the <a href=\"https://azure.microsoft.com/en-us/pricing/tco/calculator/\">Microsoft Total Cost of Ownership (TCO) Calculator</a>.</p>\n\n\n\n<div class=\"wp-block-file\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/OnPremise-cost.xlsx\">OnPremise-cost</a><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/OnPremise-cost.xlsx\" class=\"wp-block-file__button\" download>Download</a></div>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/17-On-premise-costs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/17-On-premise-costs-1024x561.png\" alt=\"\" class=\"wp-image-311\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/17-On-premise-costs-1024x561.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/17-On-premise-costs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/17-On-premise-costs-768x421.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 17</strong><br>Excel sheet used to calculate and populate daily costs</figcaption></figure>\n\n\n\n<p>The On-premise costs can be monitored by expense category and sliced by physical server (Figures 18 and 19).</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/18-on-prem-cost-by-expense-category.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/18-on-prem-cost-by-expense-category-1024x560.png\" alt=\"\" class=\"wp-image-312\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/18-on-prem-cost-by-expense-category-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/18-on-prem-cost-by-expense-category-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/18-on-prem-cost-by-expense-category-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 18</strong><br>On premise costs by expense category</figcaption></figure>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/19-linux-server-a-costs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/19-linux-server-a-costs-1024x560.png\" alt=\"\" class=\"wp-image-313\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/19-linux-server-a-costs-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/19-linux-server-a-costs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/19-linux-server-a-costs-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 19</strong><br>Costs for Linux Server A by expense category</figcaption></figure>\n\n\n\n<p>Finally we can look at amortized on-premise costs as in Figure 20.</p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/20-amortized-hardware-costs.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/20-amortized-hardware-costs-1024x560.png\" alt=\"\" class=\"wp-image-315\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/20-amortized-hardware-costs-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/20-amortized-hardware-costs-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/20-amortized-hardware-costs-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 20</strong><br>Amortized On-premise Hardware costs</figcaption></figure>\n\n\n\n<p>Observe that the <a href=\"https://en.wikipedia.org/wiki/Marginal_cost\">marginal c</a><a href=\"ttps://en.wikipedia.org/wiki/Marginal_cost\">ost</a> changes on September 1st, 2021. This is because the Linux Server A is fully paid on that date from an accounting point of view.</p>\n\n\n\n<h2 id=\"what-s-my-return-on-investment\">What&#8217;s my Return on Investment?</h2>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>OK Emmanuel, nice colorful charts&#8230; But <strong>what am I getting for my money?</strong></p><cite>The Boss</cite></blockquote>\n\n\n\n<p>Collecting the usage and cost data for <em><strong>all resources, in near real time, no matter where they&#8217;re deployed</strong></em>, is only the beginning. The benefits that ensue are:</p>\n\n\n\n<ul><li>Capability of <em>&#8220;</em><a href=\"https://en.wikipedia.org/wiki/Shift-left_testing\"><em>Shifting Left</em></a><em>&#8221; Cost Estimation and Optimization</em> when exploring, architecting, and implementing a software solution iteratively</li><li><em>Cost </em><a href=\"https://en.wikipedia.org/wiki/Anomaly_detection\"><em>Anomaly Detection</em></a> in near-real time (see Figure 21)</li><li><em><strong>Accurate and predictable budget forecasting</strong></em> especially when comparing similarly sized projects implemented in a similar fashion</li><li>When combined with performance metrics, more accurate <a href=\"https://en.wikipedia.org/wiki/Price%E2%80%93performance_ratio\">Price-Performance ratios</a></li><li>Better alignment of cloud pricing models to the various workloads (see  &#8220;<a href=\"https://www.gartner.com/en/webinars/3991979/the-future-of-data-analytics-is-in-the-cloud\">The Future of Data &amp; Analytics is in the Cloud</a>&#8221; by <a href=\"https://www.gartner.com/analyst/52420/Adam-Ronthal\">Adam Ronthal</a>)</li><li>Calculate and forecast migration costs and <a href=\"https://en.wikipedia.org/wiki/Total_cost_of_ownership\">Total Cost of Ownership</a> (TCO) more accurately</li><li>Better controls on financial governance</li><li>Begin your journey in <a href=\"https://www.finops.org/\">FinOps</a>!</li></ul>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/21-sample-cost-anomaly.png\"><img src=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/21-sample-cost-anomaly-1024x560.png\" alt=\"\" class=\"wp-image-334\" srcset=\"https://blog.devopsabcs.com/wp-content/uploads/2021/01/21-sample-cost-anomaly-1024x560.png 1024w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/21-sample-cost-anomaly-300x164.png 300w, https://blog.devopsabcs.com/wp-content/uploads/2021/01/21-sample-cost-anomaly-768x420.png 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></a><figcaption><strong>Figure 21</strong><br>Sample Cost Anomaly</figcaption></figure>\n\n\n\n<h2>Next Steps</h2>\n\n\n\n<p>Hopefully, you&#8217;re convinced on the value of collecting the usage and cost data for <em><strong>all resources, in near real time, no matter where they&#8217;re deployed</strong></em>. </p>\n\n\n\n<p>To start off on the right foot:</p>\n\n\n\n<ul><li>Start with a proper governance review &#8211; ensure you&#8217;re grouping or tagging resources early in alignment with your corporate and financial governance</li><li>Start collecting and warehousing cost and usage data <strong><em>now</em></strong>! Early and inaccurate feedback is better than no feedback at all! Like any other process, it&#8217;s iterative. Finally many CSPs do not allow you to collect data retroactively</li><li>Bring everyone impacted <em>early</em> to the table</li></ul>\n\n\n\n<h3>Further Exploration</h3>\n\n\n\n<ul><li><a href=\"https://docs.microsoft.com/en-us/azure/architecture/framework/\">Microsoft Azure Well-Architected Framework</a></li><li><a href=\"https://www.gartner.com/en/webinars/3991979/the-future-of-data-analytics-is-in-the-cloud\">The Future of Data &amp; Analytics is in the Cloud (Gartner)</a></li><li><a href=\"https://en.wikipedia.org/wiki/Accuracy_and_precision\">Accuracy and precision &#8211; Wikipedia</a>  </li></ul>", "category": ["Architecture", "Cloud Economics", "Cost Optimization", "Financial Governance", "FinOps", "Governance", "AWS", "Azure", "Cost Anomaly Detection", "GCP", "On-Premise", "Well-Architected Framework"], "source": "https://blog.devopsabcs.com/index.php/feed/", "processed": false}